<?php
// Œî·ΩπŒæŒ± œÉŒøŒπ ·ΩÅ ŒòŒµ·Ω∏œÇ ·º°Œº·ø∂ŒΩ, Œ¥·ΩπŒæŒ± œÉŒøŒπ.
// –°–ª–∞ÃÅ–≤–∞ —Ç–µ–±—£ÃÄ –±–∂“É–µ –Ω–∞ÃÅ—à—ä, —Å–ª–∞ÃÅ–≤–∞ —Ç–µ–±—£ÃÄ.
// Glory to Thee, our God, glory to Thee.
    
    
include_once("csl_utils.php");

// We NEED word length in occurences, even though it impacts size & performance
// this makes possible to normalize words, not only –π but variants of i with . and .., ou with narrow and normal o and whatever else can be found
//  position is now pos | size << 24, since pos is hopefully always less than 16000000 and word size way less than 256
// we'll use plain strlen though, mb_stlen worsens performance too much
// so... we need also search what simplifieds have too many word variants to see what else must be normalized


function csl_normalise($text, $make_lowercase = true)
{
	// decompose diacritics EXCEPT FOR –π which is a separate letter, though ponomar.net doesn't think so
    
    if ($make_lowercase)
        return strtr(mb_strtolower($text, 'UTF-8'), array('–∏ÃÜ' => '–π', '—ó' => '—ñÃà', '—∑' => '—µÃè', '—ê'=> '–µÃÄ', '—ù' => '–∏ÃÄ',
            '–æ—É“ÜÃÅ' => '·≤Ç—É“ÜÃÅ', '–æ—É“ÜÃÄ' => '·≤Ç—É“ÜÃÄ', '–æ—É“Ü' => '·≤Ç—É“Ü', // ONLY when psili is present!
				//'–æ—É' => '·≤Ç—É'
                    ));
    else
        return strtr($text, array('–∏ÃÜ' => '–π', '—ó' => '—ñÃà', '—∑' => '—µÃè', '—ê'=> '–µÃÄ', '—ù' => '–∏ÃÄ',
            //  there's no special capital of ·≤Ç 
            '–æ—É“ÜÃÅ' => '·≤Ç—É“ÜÃÅ', '–æ—É“ÜÃÄ' => '·≤Ç—É“ÜÃÄ', '–æ—É“Ü' => '·≤Ç—É“Ü',  // ONLY when psili is present!
            //'–æ—É' => '·≤Ç—É',
            '–òÃÜ' => '–ô', '–á' => '–ÜÃà', '—∂' => '—¥Ãè', '–Ä'=>'–ïÃÄ', '–ç' => '–òÃÄ'));
}


function csl_simplify_civil($text)
{
   return strtr(mb_strtolower($text, 'UTF-8'),
              array('—ù'=> '–∏', '—ê'=> '–µ', '–∏ÃÜ' => '–π',  '—ñ' => '–∏', '—ó'=> '–∏', '—°' => '–æ', '—£' => '–µ', '—ß'=> '—è', 
					mb_chr(768) => '', mb_chr(785) => '', mb_chr(834) =>  '', mb_chr(769) => '', mb_chr(847) => '',
                     mb_chr(776) => '', mb_chr(774) => '', mb_chr(783) => '', mb_chr(787) => '', mb_chr(788) => '',
                     mb_chr(1155) => '', // this is titlo ~
                     mb_chr(1158) => '', mb_chr(1159) => '',));
}


function csl_pre_simplify_book($text)
{
    // try to keep same length
    return strtr(mb_strtolower($text, 'UTF-8'),
              array('-' => ' ', '‚Ä†' => '   ', '¬´' => '  ', '¬ª' => '  ', '‚Äë' => '   ',
                   "\xc2\xa0" => '  ', '‚ÄØ' => '   ', '¬ç' => '  ',
                    
                   //chr(141) =>  '',
                    //chr(160) =>  ' ', chr(80) =>  ' ', chr(148) =>  ' ',
                        'Íô≥' => '   ', 'Íôæ' => '   ', 'üïÄ' => '    ', 'üïÅ' => '    ', 'üïÇ' => '    ', 'üïÉ' => '    ', 'üïÖ'  => '    '));
}

    

function csl_make_slavoniser_word_map($in_text, &$w_map)
{
    if (!is_array($w_map))
        return;
    
    if (empty($in_text))
        return;
    
    $text = csl_pre_simplify_book($in_text);
    unset($in_text);
    
    $separators = csl_get_separators();
    
    $word = strtok($text, $separators);
    
    $pos = 0;

    while ($word !== false)
    {
        if ($word == '')
            continue;
        
        // get word pos here
        $pos = strpos($text, $word, $pos);
        $len = strlen($word);
        
        // only now modify –π since it's in-word and changes its length
        $word = csl_normalise($word, false); // already lowercased in pre_simplify
        
        if (!isset($w_map[$word]))
        {
            $w_map[$word] = array(csl_simplify_word($word), 1);
        }
        else
        {
            $w_map[$word][1] += 1;
        }
        
        $pos = $pos + $len;
        
        $word = strtok($separators);
    }
    
    strtok('', '');
}
    
    
function csl_make_simplified_word_map($in_text)
{
    if (empty($in_text))
        return array();
	
    $text = csl_pre_simplify_book($in_text);
    
    unset($in_text);
    
    $word_map = array();
    
    $separators = csl_get_separators();
    
    $word = strtok($text, $separators);
    
    $pos = 0;

    while ($word !== false)
    {
        if ($word == '')
            continue;
        
        // get word pos here
        $pos = strpos($text, $word, $pos);
        $len = strlen($word);
        
        // only now modify –π since it's in-word and changes its length
        $word = csl_normalise($word, false); // already lowercased in pre_simplify
        
        if (!isset($word_map[$word]))
        {
            $word_map[$word] = array(csl_simplify_word($word), $pos,  $len);
        }
        else
        {
            $word_map[$word][] = $pos;
            $word_map[$word][] = $len;
        }
        
        $pos = $pos + $len;
        
        $word = strtok($separators);
    }
    
    strtok('', '');
    
    return $word_map;
}





function csl_simplify_word($csl)
{
    if (empty($csl))
        return '';
    
    $replace = array(
                     // Perhaps there's a better way to convert Slavonic numbers than just searching
                     // over a list of {every number up to 500 + several larger ones that
                     // are known to exist in the texts}.
                     // But we need to differentiate them with titlo words along the way
                     // and there are several rather abmigous cases.
                     // So simple algorithms like:
                     // 'if it contains a titlo, try to find a fitting titlo word
                     // and if that is not found, use number conversion function'
                     // won't work all the time - small titlo words or word parts will
                     // definitely be found inside numerals, and vise versa,
                     // and we'll get some rather ugly-looking words.
                     // So either it's multi-stage replacement, perhaps
                     // 'long titlo words' then 'numbers' then 'short titlo words'
                     // (and defining proper 'long' and 'short' may prove not quite trivial)
                     // or we try to keep the replacement simple and one-stage - like we do now.
                     // Then the replacements should contain every number we want to convert
                     // and PHP's strtr algorithm will take care of length,
                     // replacing longer strings first (and length in bytes it uses works OK).
                     // So far, this long and not exactly beautiful-looking list of replacements
                     // seems to be working and correctly simplifying & converting to Civil letters
                     // or Arabic numbers, never mixing them. We must keep watching out for errors though.
                     
                     
                     // bigger number titlos - at least some
                     '“Ç–∑—Ä–∫“É–∞'=>'7121', '“Ç–∑—É–º“É—ï'=>'7446',
                     '“Ç–∞—±“É—≥'=>'1709', '“Ç–∞—ø—á“É–≥'=>'1893',
                     '“Ç–∞—Ä“É–¥'=>'1104', '“Ç–∞—Ö—ª“É—î'=>'1675',
                     '“Ç–∞“É—Ü“É—á“É–∞“É'=>'1991', '“Ç–∞—Ü–∑“É—ñ'=>'1917', '“Ç–∞—Ü–ª“É–∏'=>'1938', '“Ç–∞—Ü–ø“É–∞'=>'1981', '“Ç–∞—Ü–ø“É–¥'=>'1984', '“Ç–∞—Ü—á“É–∑'=>'1997', '“Ç–∞—Ü—á“É—ï'=>'1996',
                     '“Ç–∞—Ü“É–ø'=>'1980', '“Ç–∞—Ü“É—ª'=>'1970',
                     '“Ç–∞“É—Ñ'=>'1500', '“Ç—ï—á“É–∞'=>'6091',
                     '“Ç–∞“É—ï'=>'1006',
                     '“Ç–∞'=>'1000', '“Ç–∑'=>'7000', '“Ç—ï“É'=>'6000', '—Å–Ω“É—≥'=> '259',
                     '—Ñ–∞“É—ñ'=>'511', '—É–∞“É—ñ'=>'411', '—Ç–∞“É—ñ'=>'311', '—Å–∞“É—ñ'=>'211', '—Ä–∞“É—ñÃà'=>'111',  '—Ä–∞“É—ñ'=>'111',
                     '—Ä–≤“É—ñ'=>'112', '—Ä–≤“É—ñÃà'=>'112', '—Å–≤“É—ñ'=>'212', '—Ç–≤“É—ñ'=>'312', '—É–≤“É—ñ'=>'412', '—Ñ–≤“É—ñ'=>'512',
                     '—Å–≥“É—ñ'=>'213', '—Å–≥“É—ñÃà'=>'213', '—Ä–≥“É—ñ'=>'113', '—Ä–≥“É—ñÃà'=>'113', '—Ç–≥“É—ñ'=>'313', '—É–≥“É—ñ'=>'413', '—Ñ–≥“É—ñ'=>'513',
                     
                     '—Å—á“É—ï'=>'296', '—Ä–ª“É—î'=>'235', '—Ä–º“É—≥'=>'149', '—Ä–º“É—ï'=>'146', '—Å—ª“É—î'=>'275', '—Ä—î“É—ñ'=>'115', '—Ä–º“É–¥'=>'144',
                     '—Ä–¥“É—ñ'=>'114', '—Ä—ï“É—ñ'=>'116', '—Ä–∑“É—ñ'=>'117', '—Ä–∏“É—ñ'=>'118', '—Ä—≥“É—ñ'=>'119', '—Ä–∫“É–∞'=>'221', '—Ä–∫“É–≤'=>'222',
                     '—Ä–∫“É–≥'=>'123', '—Ä–∫“É–¥'=>'124', '—Ä–∫“É—î'=>'125', '—Ä–∫“É—ï'=>'126', '—Ä–∫“É–∑'=>'127', '—Ä–∫“É–∏'=>'128', '—Ä–∫“É—≥'=>'129',
                     '—Ä–ª“É–∞'=>'131', '—Ä–º“É–≤'=>'142', '—Ä–ª“É–≤'=>'132', '—Ä–ª“É–≥'=>'133', '—Ä–ª“É–¥'=>'134', '—Ä–ª“É—ï'=>'136', '—Ä–ª“É–∑'=>'137',
                     '—Ä–ª“É–∏'=>'138','—Ä–ª“É—≥'=>'139','—Ä–º“É–∞'=>'141','—Ä–º“É–≥'=>'143','—Å—á“É–≤'=>'292','—Ä–º“É—î'=>'145','—Ä–º“É–∑'=>'147','—Ä–º“É–∏'=>'148',
                     '—Ä–Ω“É–∞'=>'151','—Ç–∫“É—≥'=>'329','—Ä–Ω“É–≤'=>'152', '—Ä–Ω“É–≥'=>'153','—Ä–Ω“É–¥'=>'154','—Ä–Ω“É—î'=>'155', '—Ä–Ω“É—ï'=>'156','—Ä–Ω“É–∑'=>'157',
                     '—Ä–Ω“É–∏'=>'158', '—Ä–Ω“É—≥'=>'159','—Ä—Ø“É–∞'=>'161','—Ä—Ø“É–≤'=>'162','—Ä—Ø“É–≥'=>'163','—Ä—Ø“É–¥'=>'164','—Ä—Ø“É—î'=>'165','—Ä—Ø“É—ï'=>'166',
                     '—Ä—Ø“É–∑'=>'167', '—Ä—Ø“É–∏'=>'168','—Ä—Ø“É—≥'=>'169', '—Ä—ª“É–∞'=>'171','—Ä—ª“É–≤'=>'172','—Ä—ª“É–≥'=>'173', '—Ä—ª“É–¥'=>'174','—Ä—ª“É—î'=>'175',
                     '—Ä—ª“É—ï'=>'176', '—Ä—ª“É–∑'=>'177', '—Ä—ª“É–∏'=>'178', '—Ä—ª“É—≥'=>'179','—Ä–ø“É–∞'=>'181', '—Ä–ø“É–≤'=>'182','—Ä–ø“É–≥'=>'183', '—Ä–ø“É–¥'=>'184',
                     '—Ä–ø“É—î'=>'185', '—Ä–ø“É—ï'=>'186','—Ä–ø“É–∑'=>'187','—Ä–ø“É–∏'=>'188', '—Ä–ø“É—≥'=>'189','—Ä—á“É–∞'=>'191','—Ä—á“É–≤'=>'192','—Ä—á“É–≥'=>'193',
                     '—Ä—á“É–¥'=>'194', '—Ä—á“É—î'=>'195','—Ä—á“É—ï'=>'196','—Ä—á“É–∑'=>'197', '—Ä—á“É–∏'=>'198', '—Ä—á“É—≥'=>'199', '—Ä“É—ª'=>'170',
                     
                     '—Å–¥“É—ñ'=>'214','—Å—î“É—ñ'=>'215','—Å—ï“É—ñ'=>'216','—Å–∑“É—ñ'=>'217','—Å–∏“É—ñ'=>'218','—Å—≥“É—ñ'=>'219','—Å–∫“É–∞'=>'221','—Å–∫“É–≤'=>'222',
                     '—Å–∫“É–≥'=>'223','—Ç–∫“É—î'=>'325','—Å–∫“É–¥'=>'224','—Å–∫“É—î'=>'225','—Å–∫“É—ï'=>'226','—Å–∫“É–∑'=>'227','—Å–∫“É–∏'=>'228','—Å–∫“É—≥'=>'229',
                     '—Å–ª“É–∞'=>'231','—Å–ª“É–≤'=>'232','—Å–ª“É–≥'=>'233', '—Å–ª“É–¥'=>'234','—Å–ª“É—î'=>'235','—Å–ª“É—ï'=>'236','—Å–ª“É–∑'=>'237','—Å–ª“É–∏'=>'238',
                     '—Å–ª“É—≥'=>'239','—Å–º“É–∞'=>'241','—Å–º“É–≤'=>'242','—Å–º“É–≥'=>'243','—Å–º“É–¥'=>'244','—Å–º“É—î'=>'245','—Å–º“É—ï'=>'246','—Å–º“É–∑'=>'247',
                     '—Å–º“É–∏'=>'248','—Å–º“É—≥'=>'249','—Å–Ω“É–≤'=>'252','—Å–Ω“É–≥'=>'253','—Å–Ω“É–¥'=>'254','—Å–Ω“É—î'=>'255','—Å–Ω“É—ï'=>'256','—Å–Ω“É–∑'=>'257',
                     '—Å–Ω“É–∏'=>'258','—Å–Ω“É—≥'=>'259','—Å—Ø“É–∞'=>'261','—Å—Ø“É–≤'=>'262','—Å—Ø“É–≥'=>'263','—Å—Ø“É–¥'=>'264','—Å—Ø“É—î'=>'265','—Å—Ø“É—ï'=>'266',
                     '—Å—Ø“É–∑'=>'267','—Å—Ø“É–∏'=>'268','—Å—Ø“É—≥'=>'269','—Å—ª“É–∞'=>'271','—Å—ª“É–≤'=>'272','—Å—ª“É–≥'=>'273','—Å—ª“É–¥'=>'274', 
                     '—Ç–¥“É—ñ'=>'314','—Å—ª“É—ï'=>'276','—Å—ª“É–∑'=>'277','—Å—ª“É–∏'=>'278','—Å—ª“É—≥'=>'279','—Å–ø“É–∞'=>'281', '—Å–ø“É–≤'=>'282','—Å–ø“É–≥'=>'283',
                     '—Å–ø“É–¥'=>'284','—Å–ø“É—î'=>'285','—Å–ø“É—ï'=>'286','—Å–ø“É–∑'=>'287','—Å–ø“É–∏'=>'288','—Å–ø“É—≥'=>'289', '—Å—á“É–∞'=>'291','—Å—á“É–≥'=>'293',
                     '—Å—á“É–¥'=>'294','—Å—á“É—î'=>'295','—Å—á“É–∑'=>'297','—Å—á“É–∏'=>'298','—Å—á“É—≥'=>'299',

					// '—Å–Ω“É–∞'=>'251', usually NOT a number though context dependent.
                    // (and thus can't be always correctly identified without AI)
                    // in any case it's better to be wrong on the word side, not number side
 
                     '—Ç—î“É—ñ'=>'315','—Ç—ï“É—ñ'=>'316','—Ç–∑“É—ñ'=>'317','—Ç–∏“É—ñ'=>'318','—Ç—≥“É—ñ'=>'319','—Ç–∫“É–∞'=>'321','—Ç–∫“É–≤'=>'322','—Ç–∫“É–≥'=>'323',
                     '—Ç–∫“É–¥'=>'324','—Ç–∫“É—ï'=>'326','—Ç–∫“É–∑'=>'327','—Ç–∫“É–∏'=>'328','—Ç–ª“É–∞'=>'331','—Ç–ª“É–≤'=>'332','—Ç–ª“É–≥'=>'333','—Ç–ª“É–¥'=>'334',
                     '—Ç–ª“É—î'=>'335','—Ç–ª“É—ï'=>'336','—Ç–ª“É–∑'=>'337','—Ç–ª“É–∏'=>'338','—Ç–ª“É—≥'=>'339','—Ç–º“É–∞'=>'341','—Ç–º“É–≤'=>'342','—Ç–º“É–≥'=>'343',
                     '—Ç–º“É–¥'=>'344','—Ç–º“É—î'=>'345','—Ç–º“É—ï'=>'346','—Ç–º“É–∑'=>'347','—Ç–º“É–∏'=>'348','—Ç–º“É—≥'=>'349','—Ç–Ω“É–∞'=>'351','—Ç–Ω“É–≤'=>'352',
                     '—Ç–Ω“É–≥'=>'353','—Ç–Ω“É–¥'=>'354','—Ç–Ω“É—î'=>'355','—Ç–Ω“É—ï'=>'356','—Ç–Ω“É–∑'=>'357','—Ç–Ω“É–∏'=>'358','—Ç–Ω“É—≥'=>'359','—Ç—Ø“É–∞'=>'361',
                     '—Ç—Ø“É–≤'=>'362','—Ç—Ø“É–≥'=>'363','—Ç—Ø“É–¥'=>'364','—Ç—Ø“É—î'=>'365','—Ç—Ø“É—ï'=>'366','—Ç—Ø“É–∑'=>'367','—Ç—Ø“É–∏'=>'368','—Ç—Ø“É—≥'=>'369',
                     '—Ç—ª“É–∞'=>'371','—Ç—ª“É–≤'=>'372','—Ç—ª“É–≥'=>'373','—Ç—ª“É–¥'=>'374','—Ç—ª“É—î'=>'375','—Ç—ª“É—ï'=>'376','—Ç—ª“É–∑'=>'377','—Ç—ª“É–Ω'=>'378',
                     '—Ç—ª“É–∏'=>'378','—Ç—ª“É—≥'=>'379','—Ç–ø“É–∞'=>'381','—Ç–ø“É–≤'=>'382','—Ç–ø“É–≥'=>'383','—Ç–ø“É–¥'=>'384','—Ç–ø“É—î'=>'385','—Ç–ø“É—ï'=>'386',
                     '—Ç–ø“É–∑'=>'387','—Ç–ø“É–∏'=>'388','—Ç–ø“É—≥'=>'389','—Ç—á“É–∞'=>'391','—Ç—á“É–≤'=>'392','—Ç—á“É–≥'=>'393','—Ç—á“É–¥'=>'394','—Ç—á“É—î'=>'395',
                     '—Ç—á“É—ï'=>'396','—Ç—á“É–∑'=>'397','—Ç—á“É–∏'=>'398','—Ç—á“É—≥'=>'399','—É–∞“É—ñ'=>'411','—É–≤“É—ñ'=>'412','—É–≥“É—ñ'=>'413','—É–¥“É—ñ'=>'414',
                     '—É—î“É—ñ'=>'415','—É—ï“É—ñ'=>'416','—É–∑“É—ñ'=>'417','—É–∏“É—ñ'=>'418','—É—≥“É—ñ'=>'419','—É–∫“É–∞'=>'421','—É–∫“É–≤'=>'422','—É–∫“É–≥'=>'423',
                     '—É–∫“É–¥'=>'424','—É–∫“É—î'=>'425','—É–∫“É—ï'=>'426','—É–∫“É–∑'=>'427','—É–∫“É–∏'=>'428','—É–∫“É—≥'=>'429','—É–ª“É–∞'=>'431','—É–ª“É–≤'=>'432',
                     '—É–ª“É–≥'=>'433','—É–ª“É–¥'=>'434','—É–ª“É—î'=>'435','—É–ª“É—ï'=>'436','—É–ª“É–∑'=>'437','—É–ª“É–∏'=>'438','—É–ª“É—≥'=>'439','—É–º“É–∞'=>'441',
                     '—É–º“É–≤'=>'442','—É–º“É–≥'=>'443','—É–º“É–¥'=>'444','—É–º“É—ï'=>'446','—É–º“É–∑'=>'447','—É–º“É–∏'=>'448','—É–º“É—≥'=>'449','—É–Ω“É–∞'=>'451',
                     '—É–Ω“É–≤'=>'452','—É–Ω“É–≥'=>'453', '—É–Ω“É–¥'=>'454','—É–Ω“É—î'=>'455','—É–Ω“É—ï'=>'456','—É–Ω“É–∑'=>'457','—É–Ω“É–∏'=>'458','—É–Ω“É—≥'=>'459',
                     '—É—Ø“É–∞'=>'461','—É—Ø“É–≤'=>'462','—É—Ø“É–≥'=>'463','—É—Ø“É–¥'=>'464','—É—Ø“É—î'=>'465','—É—Ø“É—ï'=>'466','—É—Ø“É–∑'=>'467','—É—Ø“É–∏'=>'468',
                     '—É—Ø“É—≥'=>'469','—É—ª“É–∞'=>'471','—É—ª“É–≤'=>'472','—É—ª“É–≥'=>'473','—É—ª“É–¥'=>'474','—É—ª“É—î'=>'475','—É—ª“É—ï'=>'476','—É—ª“É–∑'=>'477',
                     '—É—ª“É–∏'=>'478','—É—ª“É—≥'=>'479','—É–ø“É–∞'=>'481','—É–ø“É–≤'=>'482','—É–ø“É–≥'=>'483','—É–ø“É–¥'=>'484','—É–ø“É—î'=>'485','—É–ø“É—ï'=>'486',
                     '—É–ø“É–∑'=>'487','—É–ø“É–∏'=>'488','—É–ø“É—≥'=>'489','—É—á“É–∞'=>'491','—É—á“É–≤'=>'492','—É—á“É–≥'=>'493','—É—á“É–¥'=>'494','—É—á“É—î'=>'495',
                     '—É—á“É—ï'=>'496','—É—á“É–∑'=>'497','—É—á“É–∏'=>'498','—É—á“É—≥'=>'499','—Ç–Ω“É–µ'=>'355','—Ö—ª“É–∏'=>'678','—É–º“É—î'=>'445','—Ñ–∞“É—ñ'=>'511',
                     '—Ñ–≤“É—ñ'=>'512','—Ñ–≥“É—ñ'=>'513','—Ñ–¥“É—ñ'=>'514','—Ñ—î“É—ñ'=>'515','—Ñ—ï“É—ñ'=>'516','—Ñ–∑“É—ñ'=>'517','—Ñ–∏“É—ñ'=>'518','—Ñ—≥“É—ñ'=>'519',
                     '—Ñ–∫“É–∞'=>'521','—Ñ–∫“É–≤'=>'522','—Ñ–∫“É–≥'=>'523','—Ñ–∫“É–¥'=>'524','—Ñ–∫“É—î'=>'525','—Ñ–∫“É—ï'=>'526','—Ñ–∫“É–∑'=>'527','—Ñ–∫“É–∏'=>'528',
                     '—Ñ–∫“É—≥'=>'529','—Ñ–ª“É–∞'=>'531','—Ñ–ª“É–≤'=>'532','—Ñ–ª“É–≥'=>'533','—Ñ–ª“É–¥'=>'534','—Ñ–ª“É—î'=>'535','—Ñ–ª“É—ï'=>'536','—Ñ–ª“É–∑'=>'537',
                     '—Ñ–ª“É–∏'=>'538','—Ñ–ª“É—≥'=>'539','—Ñ–º“É–∞'=>'541','—Ñ–º“É–≤'=>'542','—Ñ–º“É–≥'=>'543','—î“É—ñÃà'=>'15','—ï“É—ñÃà'=>'16','—≥“É—ñÃà'=>'19','—Å“É—ñÃà'=>'210',
                     
                     '—Ä“É–∞'=>'101','—Å“É—ª'=>'270','—Ä“É—î'=>'105','—Å“É–º'=>'240','—Ä“É–º'=>'140','—Ä“É—ï'=>'106','—Ä“É–≤'=>'102','—Ä“É–≥'=>'103','—Ä“É–¥'=>'104',
                     '—Ä“É–∑'=>'107','—Ä“É–∏'=>'108','—Ä“É—≥'=>'109','—Ä“É—ñ'=>'110','—Ä“É–∫'=>'120','—Ä“É–ª'=>'130','—Ä“É–Ω'=>'150','—Ä“É—Ø'=>'160','—Ä“É–ø'=>'180',
                     '—Ç“É–≥'=>'303','—Ç“É—≥'=>'309','—Ä“É—á'=>'190','—Ç“É–¥'=>'304','—Å“É–∞'=>'201','—Å“É–≤'=>'202','—Å“É–≥'=>'203','—Å“É–¥'=>'204','—Å“É—î'=>'205',
                     '—Å“É—ï'=>'206','—Å“É–∑'=>'207','—Å“É–∏'=>'208','—Å“É—≥'=>'209','—Å“É—ñ'=>'210','—Å“É–∫'=>'220','—Å“É–ª'=>'230','—Å“É–Ω'=>'250','—Å“É—Ø'=>'260',
                     '—Å“É–ø'=>'280','—Å“É—á'=>'290','—Ç“É–∞'=>'301','—Ç“É–≤'=>'302','—Ç“É—î'=>'304','—Ç“É—ï'=>'306','—Ç“É–∑'=>'307','—Ç“É–∏'=>'308','—Ç“É—ñ'=>'310',
                     '—Ç“É–∫'=>'320','—Ç“É–ª'=>'330','—Ç“É–º'=>'340','—Ç“É–Ω'=>'350','—Ç“É—Ø'=>'360','—Ç“É—ª'=>'370','—Ç“É–ø'=>'380','—Ç“É—á'=>'390','—É“É–∞'=>'401',
                     '—É“É–≤'=>'402','—É“É–≥'=>'403','—É“É–¥'=>'404','—É“É—î'=>'405','—É“É—ï'=>'406','—É“É–∑'=>'407','—É“É–∏'=>'408','—É“É—≥'=>'409','—É“É—ñ'=>'410',
                     '—Ä—Ø“É'=>'160','—É“É–∫'=>'420','—É“É–ª'=>'430','—É“É–º'=>'440','—É“É–Ω'=>'450','—É“É—Ø'=>'460','—É“É—ª'=>'470','—É“É–ø'=>'480','—É“É—á'=>'490',
                     '—Ñ“É–∞'=>'501','—Ñ“É–≤'=>'502','—Ñ“É–≥'=>'503','—Ñ“É–¥'=>'504','—Ñ“É—î'=>'505','—Ñ“É—ï'=>'506','—Ñ“É–∑'=>'507','—Ñ“É–∏'=>'508','—Ñ“É—≥'=>'509',
                     '—Ñ“É—ñ'=>'510','—Ñ“É–∫'=>'520','—Ñ“É–ª'=>'530','—Ñ“É–º'=>'540','—Å–º“É'=>'240','—É–Ω“É'=>'450','—Ø“É–µ'=>'65','—Å“É–æ'=>'270','–æ“É–∞'=>'71',
                     '—Å“É—Ø“É—ï'=>'266',
                     
                                    
                     
                     '—ñ—ñ'=> 'II', // Latin num
                     
                     // some known titlos
                     '—ñ“Ü–∏“É—ÅÍôãÃÅ—Å'=> '–∏–∏—Å—É—Å', '—ñ“Ü–∏“É—Å' => '–∏–∏—Å—É—Å',  '–Ü“Ü—Å“É'=> '–∏–∏—Å—É—Å', '—ñ“Ü—Å“É'=> '–∏–∏—Å—É—Å',
                     '—Ö–≤‚∑≠“á'=> '—Ö—Ä–∏—Å—Ç–æ–≤', '—Ö—Ä‚∑≠“á—Ç' => '—Ö—Ä–∏—Å—Ç', '—Ö“É—Å'=> '—Ö—Ä–∏—Å—Ç–æ—Å',
                     '–Ω–±‚∑≠“á' => '–Ω–µ–±–µ—Å',
                     '–≥–¥‚∑≠“á–Ω—å'=> '–≥–æ—Å–ø–æ–¥–µ–Ω—å', '–∫—Ä‚∑≠“á—Ç–æ–±–æ‚∑¢“á'=> '–∫—Ä–µ—Å—Ç–æ–±–æ–≥.', '–≥–¥‚∑≠'=> '–≥–æ—Å–ø–æ–¥', 
                     '–≥–¥‚∑≠“á—Ä–Ω'=> '–≥–æ—Å—É–¥–∞—Ä—ã–Ω', '–≥–¥‚∑≠“á—Ä'=> '–≥–æ—Å—É–¥–∞—Ä', '–≥–∂‚∑≠“á'=> '–≥–æ—Å–ø–æ–∂', '–≥–ø‚∑≠“á–∂'=> '–≥–æ—Å–ø–æ–∂', '–¥–≤‚∑≠“á—Ç'=> '–¥–µ–≤—Å—Ç',
                     '–±–≥“É–∑'=> '–±–æ–≥–æ–∑',
                     '–≥–¥‚∑≠“á–≤'=> '–≥–æ—Å–ø–æ–¥–µ–≤', '–≥–¥‚∑≠“á–∫'=> '–≥–æ—Å–ø–æ–¥—Å–∫', '–≥–¥‚∑≠“á'=> '–≥–æ—Å–ø–æ–¥',  '–ø—Ä—Å—Ç“É'=> '–ø—Ä–µ—Å–≤—è—Ç',
                     '—Å—Ç“É–ª'=> '—Å–≤—è—Ç–∏—Ç–µ–ª', '—Å—Ç“É—Ç'=> '—Å–≤—è—Ç–∏—Ç',  '—Å—Ç“É–∞ÃÅ—°'=> '—Å–≤—è—Ç–∞–≥–æ', '—Å—Ç“É'=> '—Å–≤—è—Ç',
                     '–±–∂“É—Ç'=> '–±–æ–∂–µ—Å—Ç', '–±–∂“É—Å'=> '–±–æ–∂–µ—Å', '–±–∂“É'=> '–±–æ–∂', '–±–≥“É'=> '–±–æ–≥', '–±–∑“É'=> '–±–æ–∑',
                     '–Ω–±“É–æ'=> '–Ω–µ–±–æ', '–Ω“É–±–µ'=> '–Ω–µ–±–µ',  '–Ω–±“É—Å'=> '–Ω–µ–±–µ—Å', '–Ω–±“É'=> '–Ω–µ–±', '—Å–ª“É–Ω—á'=> '—Å–æ–ª–Ω–µ—á', '—Å–ª“É–Ω'=> '—Å–æ–ª–Ω',
                     '—Ç—Ä‚∑™“á—Ü'=> '—Ç—Ä–æ–∏—Ü', '—Ç—Ä‚∑™“á—á'=> '—Ç—Ä–æ–∏—á', '—Ä–æ–∂‚∑≠“á—Ç'=> '—Ä–æ–∂–¥–µ—Å—Ç', '—Å–ø‚∑≠“á–Ω'=> '—Å–ø–∞—Å–µ–Ω', '—Å–ø‚∑≠“á—Ç'=> '—Å–ø–∞—Å—Ç', '—Å–ø‚∑≠“á'=> '—Å–ø–∞—Å',  '—Ç—Ä‚∑≠“á—Ç'=> '—Ç—Ä–∏—Å–≤—è—Ç',
                     '–±–∂‚∑≠“á—Ç'=> '–±–æ–∂–µ—Å—Ç', '—Ä–∂‚∑≠“á—Ç'=> '—Ä–æ–∂–¥–µ—Å—Ç', '–ø—Ä‚∑≠“á–Ω–æ'=> '–ø—Ä–∏—Å–Ω–æ', '–ø—Ä‚∑≠“á–Ω'=> '–ø—Ä–∏—Å–Ω',
                     '–¥–≤“É–¥'=> '–¥–∞–≤–∏–¥', '–ø—Ä‚∑≠“á—Ç–æ–ª'=> '–ø—Ä–µ—Å—Ç–æ–ª', '–ø—Ä‚∑≠“á—Ç–æÃÅ–ª'=> '–ø—Ä–µ—Å—Ç–æ–ª',
                     '–±—Ü‚∑£'=> '–±–æ–≥–æ—Ä–æ–¥–∏—Ü', '–¥–≤“É—Ü'=> '–¥–µ–≤–∏—Ü', '–¥–≤“É—á'=> '–¥–µ–≤–∏—á', '–¥–≤“É'=> '–¥–µ–≤', '–¥“É–≤'=> '–¥–µ–≤', '–º—Ç“É—Ä'=> '–º–∞—Ç–µ—Ä', '–º—Ç“É'=> '–º–∞—Ç', '–±—á‚∑£'=> '–±–æ–≥–æ—Ä–æ–¥–∏—á',
                     '–ø—Ä‚∑£—Ç—á'=> '–ø—Ä–µ–¥—Ç–µ—á', '–ø—Ä‚∑£—Ç'=> '–ø—Ä–µ–¥—Ç', '–∫–Ω“É–∑'=> '–∫–Ω—è–∑', '–∫–Ω“É–≥'=> '–∫–Ω—è–≥', '–∫–Ω“É–∂'=> '–∫–Ω—è–∂',
                     '–ø—Ä–µ—á‚∑≠“á—Ç–µ–Ω'=> '–ø—Ä–µ—á–µ—Å—Ç–µ–Ω', '–ø—Ä–µ—á‚∑≠“á—Ç–∞ÃÅ—ß'=> '–ø—Ä–µ—á–µ—Å—Ç–Ω–∞—è', '–ø—Ä–∏—á‚∑≠“á'=> '–ø—Ä–∏—á–∞—Å—Ç.', '–ø—Ä–∏‚∑±“á'=> '–ø—Ä–∏—á–∞—Å—Ç.',
                     '–ø—Ä—á‚∑≠“á—Ç–∞—ß'=> '–ø—Ä–µ—á–∏—Å—Ç–∞—è', '–ø—Ä—á‚∑≠“á—Ç–Ω'=> '–ø—Ä–µ—á–µ—Å—Ç–Ω','–º—Ä“É—ñÃà–∞ÃÅ'=> '–º–∞—Ä–∏–∞', '–º—Ä“É—ñÃà'=> '–º–∞—Ä–∏', '–º—Ä“É—ñÃÅ'=> '–º–∞—Ä–∏',  '–º—Ä“É—ó'=> '–º–∞—Ä–∏',
                     '–ø—Ä—á‚∑≠“á—Ç'=> '–ø—Ä–µ—á–∏—Å—Ç', '–ø—Ä‚∑≠“á—Ç–∞ÃÅ'=> '–ø—Ä–µ—Å–≤—è—Ç–∞', '–ø—Ä‚∑≠“á—Ç—ãÃÅ'=> '–ø—Ä–µ—Å–≤—è—Ç—ã', '–ø—Ä‚∑≠“á—Ç—£ÃÅ'=> '–ø—Ä–µ—Å–≤—è—Ç–µ',
                     '—á‚∑≠“á—Ç–µ–Ω'=> '—á–µ—Å—Ç–µ–Ω', '—á—Ç‚∑≠“á–Ω'=> '—á–µ—Å—Ç–Ω', '—á‚∑≠“á—Ç–Ω'=> '—á–µ—Å—Ç–Ω',
                     '—á—Ç‚∑≠“á'=> '—á–∏—Å—Ç', '—á‚∑≠“á—Ç'=> '—á–∏—Å—Ç', '—Ü‚∑≠“á—Ä—Ç'=> '—Ü–∞—Ä—Å—Ç',
                     '—Ü—Ä“É'=> '—Ü–∞—Ä', '–≤–ª‚∑£—á–Ω—å'=> '–≤–ª–∞–¥—ã—á–µ–Ω—å', '–≤–ª‚∑£–∫'=> '–≤–ª–∞–¥—ã–∫', '–≤–ª‚∑£—Ü'=> '–≤–ª–∞–¥—ã—Ü', '–≤–ª‚∑£—á—Ü'=> '–≤–ª–∞–¥—ã—á–∏—Ü', '–≤–ª‚∑£'=> '–≤–ª–∞–¥—ã',
                     '—Ü—Ä‚∑≠“á'=> '—Ü–∞—Ä—Å', 'c–ø“É—Å'=> '—Å–ø–∞—Å', '—Å–ø“É—Å'=> '—Å–ø–∞—Å', '—Å–ø“É“É—Å'=> '—Å–ø–∞—Å',
                     '–º–ª—Ä‚∑≠“á–¥'=> '–º–∏–ª–æ—Å–µ—Ä–¥',  '–º–ª‚∑≠“á—Ç'=> '–º–∏–ª–æ—Å—Ç', '–º–ª‚∑≠“á—Ä–¥'=> '–º–∏–ª–æ—Å–µ—Ä–¥',
                     '–±–ª“É–≥–æ—á‚∑≠“á—Ç'=> '–±–ª–∞–≥–æ—á–µ—Å—Ç', '—Ü—Ä“É—Ü'=> '—Ü–∞—Ä–∏—Ü',
                     '—Å—â“É'=> '—Å–≤—è—â', '–±–ª–≥‚∑£—Ç'=> '–±–ª–∞–≥–æ–¥–∞—Ç', '–±–ª–≥‚∑≠“á–≤'=> '–±–ª–∞–≥–æ—Å–ª–æ–≤', '–±–ª–≥‚∑≠“á–ª'=> '–±–ª–∞–≥–æ—Å–ª', '–±–ª–≥‚∑≠“á—Ç'=> '–±–ª–∞–≥–æ—Å—Ç',
                     '—ª—á“É—î—Å–∫'=> '–æ—Ç–µ—á–µ—Å–∫', '—ª“Ü—á“É—Å–∫'=> '–æ—Ç–µ—á–µ—Å–∫', '—ª“Ü—á“É–µ—Å'=> '–æ—Ç–µ—á–µ—Å', '—ª“Ü—á“É—î—Å'=> '–æ—Ç–µ—á–µ—Å',
                     '—ª“Ü—Ç—á“É—Å'=> '–æ—Ç–µ—á–µ—Å', '—ª“Ü—Ç“É—á'=> '–æ—Ç–µ—á', '—Å–ª“É–≤–æ'=> '—Å–ª–æ–≤–æ', '—ª“ÜÃÅ—á“É–µ—Å'=> '–æ—Ç–µ—á–µ—Å', '—ª“Ü—á“É—å'=> '–æ—Ç–µ—á—å', '—ª“ÜÃÅ—á“É—å'=> '–æ—Ç–µ—á—å',
                     '—ª“Ü—Ü“É–∞ÃÄ'=> '–æ—Ç—Ü–∞',  '—ª—Ü“É—îÃÅ–≤'=> '–æ—Ç—Ü–µ–≤', '—ª“ÜÃÅ—á“É–µ'=> '–æ—Ç—á–µ', '—ªÃÅ—á“É–µ'=> '–æ—Ç—á–µ', '—ª“Ü—Ü“É–∞'=> '–æ—Ç—Ü–∞', '—ª—á“É–µ'=> '–æ—Ç–µ—á–µ',
                     '—ª—Ü“É–∞'=> '–æ—Ç—Ü–∞', '—ª“Ü—Ü“É—ä'=> '–æ—Ç–µ—Ü', '—ª—Ü“É—ä'=> '–æ—Ç–µ—Ü', '—ªÃÅ—á“É'=> '–æ—Ç—á', '—ª“ÜÃÅ—á“É'=> '–æ—Ç—á', '—ª“Ü—Ü“É–µÃÅ'=> '–æ—Ç—Ü–µ', '—ª“Ü—Ü“É—£ÃÄ'=> '–æ—Ç—Ü–µ', '—ª“Ü—Ü“É'=> '–æ—Ç—Ü',
                      '—ª—Ü“É'=> '–æ—Ç—Ü', '—ª“Ü—á“É'=> '–æ—Ç—á', '—ª—á“É'=> '–æ—Ç—á',
                     '—Å–Ω“É'=> '—Å—ã–Ω', '–¥—Å“É'=> '–¥—É—Å', '–¥—à“É'=> '–¥—É—à', '–¥ÃÅ—Ö“É'=> '–¥—É—Ö',  '–¥—Ö“É'=> '–¥—É—Ö', '–¥ÃÅ—à“É'=> '–¥—É—à',
                     '—Ü—Ä“É–∫–≤—å'=> '—Ü–µ—Ä–∫–æ–≤—å', '—Ü—Ä“É–∫–≤'=> '—Ü–µ—Ä–∫–≤', '—Ü—Ä“É–∫'=> '—Ü–µ—Ä–∫',
                     '–º–ª“É—Ç–≤'=> '–º–æ–ª–∏—Ç–≤', '–º–ª“É–∏ÃÅ'=> '–º–æ–ª–∏', '–º‚∑£—Ä'=> '–º—É–¥—Ä',
                     '–≤–æ—Å–∫—Ä‚∑≠“á–Ω—ã'=> '–≤–æ—Å–∫—Ä–µ—Å–Ω—ã', '–≤–æ—Å–∫—Ä‚∑≠“á–Ω—ä'=> '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω', '–≤–æ—Å–∫—Ä‚∑≠“á–Ω—ñÃà'=> '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω–∏', '–≤—Å–∫—Ä‚∑≠“á–Ω—ñÃà'=> '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω–∏',
                     '–≤–æ—Å–∫—Ä‚∑≠“á–Ω'=> '–≤–æ—Å–∫—Ä–µ—Å–Ω', '–≤–æ—Å–∫—Ä‚∑≠“á'=> '–≤–æ—Å–∫—Ä–µ—Å', '–≤–æ—Å–∫‚∑≠“á—Ä'=> '–≤–æ—Å–∫—Ä–µ—Å', '–∫—Ä‚∑≠“á—Ç–ª'=> '–∫—Ä–µ—Å—Ç–∏—Ç–µ–ª', '–∫—Ä‚∑≠“á—Ç'=> '–∫—Ä–µ—Å—Ç',
                     '–∫—Ä“É—Å'=> '–∫—Ä–µ—Å', '–∫—Ä“É—à'=> '–∫—Ä–µ—à', '–∫—Ä“É—â'=> '–∫—Ä–µ—â', '–∫—Ä“É–ª'=> '–∫—Ä–µ—Å–ª',
                     '—Å—Ç—Ä‚∑≠“á—Ç–µÃÅ—Ä'=>'—Å—Ç—Ä–∞—Å—Ç–æ—Ç–µ—Ä', '—Å—Ç—Ä‚∑≠“á—Ç'=> '—Å—Ç—Ä–∞—Å—Ç',
                     '–∞“Ü—Ä—Ö–∞ÃÅ–≥–≥“É–ª' => '–∞—Ä—Ö–∞–Ω–≥–µ–ª',  '–∞“ÜÃÅ–≥–≥“É–ª' => '–∞–Ω–≥–µ–ª', '–≥–≥“É—î–ª'=> '–Ω–≥–µ–ª',
                     '–≥“É–≥–ª'=> '–Ω–≥–µ–ª', '–Ω–≥“É–ª'=> '–Ω–≥–µ–ª', '–≥–≥“É–ª'=> '–Ω–≥–µ–ª', '–Ω–≥“É–ª'=> '–Ω–≥–µ–ª', '–≥–≥“É'=> '–Ω–≥',
                     '–∞“Ü–ø‚∑≠“á–ª' => '–∞–ø–æ—Å—Ç–æ–ª', '–∞“Ü–ø‚∑≠“á—Ç' => '–∞–ø–æ—Å—Ç', '–∞–ø‚∑≠“á–ª'=> '–∞–ø–æ—Å—Ç–æ–ª', '–∞–ø‚∑≠“á—Ç'=> '–∞–ø–æ—Å—Ç',
                     '–ø—Ä—Ä‚∑™“á–æÃÅ—á'=> '–ø—Ä–æ—Ä–æ—á', '–ø—Ä—Ä‚∑™“á—á—Ü' => '–ø—Ä–æ—Ä–æ—á–∏—Ü', '–ø—Ä—Ä‚∑™“á–∫'=> '–ø—Ä–æ—Ä–æ–∫', '–ø—Ä‚∑™“á—Ä–∫'=> '–ø—Ä–æ—Ä–æ–∫', '–ø—Ä‚∑™“á—Ä—Ü'=> '–ø—Ä–æ—Ä–æ—Ü', '–ø—Ä—Ä‚∑™“á—Ü'=> '–ø—Ä–æ—Ä–æ—Ü',
                     '–ø—Ä‚∑™“á—Ä—á'=> '–ø—Ä–æ—Ä–æ—á', '–ø—Ä—Ä‚∑™“á—á'=> '–ø—Ä–æ—Ä–æ—á', '–ø—Ä‚∑™“á—Ä'=> '–ø—Ä–æ—Ä',
                     '–º—á“É–Ω–∫'=> '–º—É—á–µ–Ω–∏–∫', '–º—á–Ω“É–∫'=> '–º—É—á–µ–Ω–∏–∫', '–º—á“É–Ω—Ü'=> '–º—É—á–µ–Ω–∏—Ü', '–º—á“É–Ω—á'=> '–º—É—á–µ–Ω–∏—á',
                     '–º—á–Ω“É'=> '–º—É—á–µ–Ω', '–º—á“É–Ω'=> '–º—É—á–µ–Ω', '–º‚∑±“áÍôã'=> '–º—É—á', '–º—á“É'=> '–º—É—á',
                     '—ñ“Ü–∏“É–ª'=> '–∏–∑—Ä–∞–∏–ª', '–ø—Ä–µ–ø‚∑£–±'=> '–ø—Ä–µ–ø–æ–¥–æ–±', '–ø—Ä–ø‚∑£–±'=> '–ø—Ä–µ–ø–æ–¥–æ–±', '–ø—Ä–ø‚∑£–Ω'=> '–ø—Ä–µ–ø–æ–¥–æ–±–Ω', '–ø—Ä‚∑£–ø–±'=> '–ø—Ä–µ–ø–æ–¥–æ–±',
                      '—ñ“Ü—î—Ä‚∑≠“á–ª'=> '–∏–µ—Ä—É—Å–∞–ª', '—ñ“Ü–µ—Ä‚∑≠“á–ª'=> '–∏–µ—Ä—É—Å–∞–ª', '–±–ª“É–≥'=> '–±–ª–∞–≥', '–±–ª“É–∂'=> '–±–ª–∞–∂', '–±–ª“É–∑'=> '–±–ª–∞–∑', '–ø—Ä‚∑£–≤–µ–Ω—ä'=> '–ø—Ä–∞–≤–µ–¥–µ–Ω',
                      '–ø—Ä–æ‚∑¶“á'=> '–ø—Ä–æ—Ä–æ–∫', '—Å–º“É—Ä—Ç'=> '—Å–º–µ—Ä—Ç', '–Ω–Ω“É—£'=> '–Ω—ã–Ω–µ', '–ø–ª“É—Ç'=> '–ø–ª–æ—Ç',
                     '·≤Ç—É“Ü—á—Ç“É–ª'=> '—É—á–∏—Ç–µ–ª', '—á—Ç“É–ª'=> '—á–∏—Ç–µ–ª', '·≤Ç—É“Ü—á—Ç“É'=> '—É—á–∏—Ç', '·≤Ç—É“Ü—á“É–Ω'=> '—É—á–µ–Ω', '—á“É—Ç–ª'=> '—á–∏—Ç–µ–ª', '—á“É—Ç'=> '—á–∏—Ç',
                     '—á–Ω“É–∫'=> '—á–µ–Ω–∏–∫','—á–Ω“É—á'=> '—á–µ–Ω–∏—á','—á–Ω“É—Ü'=> '—á–µ–Ω–∏—Ü', '—á“É–Ω–∫'=> '—á–µ–Ω–∏–∫','—á“É–Ω—á'=> '—á–µ–Ω–∏—á','—á“É–Ω—Ü'=> '—á–µ–Ω–∏—Ü', '—á–Ω“É'=> '—á–µ–Ω', '—á“É–Ω'=> '—á–µ–Ω',
                     '–ø—Ä–≤‚∑£–≤–Ω'=> '–ø—Ä–∞–≤–µ–¥–Ω', '–ø—Ä–≤‚∑£–µ–Ω'=> '–ø—Ä–∞–≤–µ–¥–µ–Ω', '–ø—Ä–≤‚∑£–Ω—ä'=> '–ø—Ä–∞–≤–µ–¥–µ–Ω', '–ø—Ä–≤‚∑£–Ω–∫'=> '–ø—Ä–∞–≤–µ–¥–Ω–∏–∫', '–ø—Ä–≤‚∑£–Ω'=> '–ø—Ä–∞–≤–µ–¥–Ω', '–ø—Ä–≤‚∑£' => '–ø—Ä–∞–≤',
                     '—î“Ü—µ‚∑¢“á–∞ÃÅ–ª' => '–µ–≤–∞–Ω–≥–µ–ª',
                     '—î“Ü—µ‚∑¢“á–ª–æ–≥–∏–º–µÃÅ–Ω–æ—Å'=> '–µ–≤–ª–æ–≥–∏–º–µ–Ω–æ—Å', //wrongly used titlo!
                     '—î“Ü—µ‚∑¢“á–ª' => '–µ–≤–∞–Ω–≥–µ–ª',   '—î—µ‚∑¢“á–ª' => '–µ–≤–∞–Ω–≥–µ–ª', '–µ—µ‚∑¢“á–ª'=> '–µ–≤–∞–Ω–≥–µ–ª', '–∑–∞‚∑±“á' => '–∑–∞—á.', '–≥–ª‚∑°“á–∞'=> '–≥–ª–∞–≤–∞', '–≥–ª–∞‚∑°“á' => '–≥–ª–∞–≤.',
                     '—±–ª“É–º'=> '–ø—Å–∞–ª–º', '—±–∞‚∑ß“á' => '–ø—Å–∞–ª–æ–º', '—±–ª“É'=> '–ø—Å–∞–ª',
                     '—á–ª“É–≤—£–∫'=> '—á–µ–ª–æ–≤–µ–∫', '—á–ª“É–∫'=> '—á–µ–ª–æ–≤–µ–∫', '—á–ª“É—Ü'=> '—á–µ–ª–æ–≤–µ—Ü', '—á–ª“É–≤'=> '—á–µ–ª–æ–≤', '—á–ª“É—á'=> '—á–µ–ª–æ–≤–µ—á', '—á“É–ª–≤'=> '—á–µ–ª–æ–≤', '—á–ª“É–æ'=> '—á–µ–ª–æ',
                     '—Å—Ä‚∑£—Ü—ä'=> '—Å–µ—Ä–¥–µ—Ü', '—Å—Ä‚∑£—á'=> '—Å–µ—Ä–¥–µ—á', '—Å—Ä‚∑£—Ü'=> '—Å–µ—Ä–¥—Ü', '—Å—Ä‚∑£–µ'=> '—Å–µ—Ä–¥—Ü–µ', '–º–ª‚∑£–Ω—Ü—ä'=> '–º–ª–∞–¥–µ–Ω–µ—Ü', '–º–ª‚∑£–Ω'=> '–º–ª–∞–¥–µ–Ω',
                     '–∏“ÜÃÅ–º‚∑¨“á–∫—ä'=> '–∏–º—è—Ä–µ–∫', '—î“Ü–ø‚∑≠“á–∫–ø'=> '–µ–ø–∏—Å–∫–æ–ø', '—î–ø–∫‚∑≠“á–ø'=> '–µ–ø–∏—Å–∫–æ–ø', '—î“Ü–ø‚∑≠“á–∫'=> '–µ–ø–∏—Å–∫', '–¥—à“É–µ'=> '–¥—É—à–µ', '–µ–ø‚∑≠“á–∫–ø'=> '–µ–ø–∏—Å–∫–æ–ø',
                     '–µ–ø‚∑≠“á–∫'=> '–µ–ø–∏—Å–∫', '–º–Ω‚∑≠“á—Ç'=> '–º–æ–Ω–∞—Å—Ç', '–≥–ª“É–≥'=> '–≥–ª–∞–≥', '–≥–ª“É'=> '–≥–ª–∞–≥–æ–ª',
                     '–º—Ü‚∑≠“á'=> '–º–µ—Å—è—Ü', '–º‚∑≠“á—Ü'=> '–º–µ—Å—è—Ü', '–º—Ü‚∑≠'=> '–º–µ—Å—è—Ü', '–º‚∑≠“á—á'=> '–º–µ—Å—è—á',
                     '—Å—Ç‚∑Ø—Ä'=> '—Å—Ç–∏—Ö–∏—Ä', '—Å‚∑Ø'=> '—Å—Ç–∏—Ö', '–∫–æ—Ä—ñÃÅ–Ω‚∑¥“á'=> '–∫–æ—Ä–∏–Ω—Ñ.', '—Ä–∏‚∑®'=> '—Ä–∏–º.',
                     '–Ω–¥‚∑ß“á'=> '–Ω–µ–¥–µ–ª',  '–ø–Ω–ª‚∑£'=> '–ø–æ–Ω–µ–¥–µ–ª', '–ø–æ–Ω–ª‚∑£–Ω'=> '–ø–æ–Ω–µ–¥–µ–ª—å–Ω', '–ø–Ω‚∑£–ª'=> '–ø–æ–Ω–µ–¥–µ–ª', '–Ω–ª‚∑£' => '–Ω–µ–¥–µ–ª', '–¥–Ω“É' => '–¥–µ–Ω',
                     //'–ø—ß‚∑¶“á'=> '–ø—è—Ç–æ–∫', '—á–µ‚∑¶“á'=> '—á–µ—Ç–≤–µ—Ä—Ç–æ–∫',
                     '—ÅÍôã‚∑†“á' => '—Å—É–±–±.', '–ø—ß‚∑¶“á' => '–ø—è—Ç.', '—á–µ‚∑¶“á' => '—á–µ—Ç.', '–≤—Ç–æ‚∑¨“á'=> '–≤—Ç–æ—Ä.', '–ø–Ω‚∑£–µ'=> '–ø–æ–Ω–µ–¥.',
                     '—Ç—Ä–∏‚∑§'=> '—Ç—Ä–∏–∂–¥—ã', '–¥–≤‚∑§–∞'=> '–¥–≤–∞–∂–¥—ã', '–¥–≤–∞‚∑§'=> '–¥–≤–∞–∂–¥—ã', '–∞‚∑§'=> '–µ–¥–∏–Ω–æ–∂–¥—ã', '–≤‚∑§'=> '–¥–≤–∞–∂–¥—ã', '–≥‚∑§'=> '—Ç—Ä–∏–∂–¥—ã', '–¥–≤‚∑§‚∑§–∞'=> '–¥–≤–∞–∂–¥—ã', '–¥‚∑§'=> '—á–µ—Ç—ã—Ä–µ–∂–¥—ã',
                     
                     '—ø—ßÃÄ'=> '–æ—Ç—ä—è', '—ø—ßÃÅ'=> '–æ—Ç—ä—è', '—ø—ßÃë'=> '–æ—Ç—ä—è', '—ø—ß'=> '–æ—Ç—ä—è',
                     '—ø–∏'=> '–æ—Ç—ä–∏', '—ø–∏ÃÅ'=> '–æ—Ç—ä–∏', '—ø–∏“Ü'=> '–æ—Ç—ä–∏',
                     '—ø–µ'=> '–æ—Ç—ä–µ', '—ø–µÃÅ' => '–æ—Ç—ä–µ', '—ø—î“ÜÃÅ' => '–æ—Ç—ä–µ', '—ø—î' => '–æ—Ç—ä–µ', '—ø—îÃÅ' => '–æ—Ç—ä–µ',
                     
                     // greek gg, gx and gk
                     '—Å—µÃè–≥–∫' => '—Å–∏–Ω–∫','—Å—µ–≥–∫'=> '—Å–∏–Ω–∫', '–∞“Ü–≥–∫' => '–∞–Ω–∫', '–ø–∞–≥–∫' => '–ø–∞–Ω–∫', '—Ç—Ä–∞–≥–∫' => '—Ç—Ä–∞–Ω–∫', '—î“Ü–≥–∫' => '–µ–Ω–∫', '—Ä–∞–≥–∫'=>'—Ä–∞–Ω–∫',
                     '–ª–æÃÅ–≥–≥' => '–ª–æ–Ω–≥', '—Å—µÃè–≥–≥' => '—Å–∏–Ω–≥', '—Å—µÃÅ–≥–≥'=>'—Å–∏–Ω–≥',  '–≥–∞ÃÅ–≥–≥' => '–≥–∞–Ω–≥', '–∞“Ü–≥–∞—≥–∞–≥–≥' => '–∞–≥–∞—Ñ–∞–Ω–≥', '—î“Ü—Ä–º—ñÃà–Ω—ñÃà–≥–≥'=> '–µ—Ä–º–∏–Ω–∏–Ω–≥',
                     '—Ä–∞—Å—Ç–æÃÅ—Ä–≥–≥'=> '—Ä–∞—Å—Ç–æ—Ä–≥–Ω', '–µ—µ–∞ÃÅ–≥–≥'=>'–µ–≤–∞–Ω–≥', '—î—µ–∞ÃÅ–≥–≥'=>'–µ–≤–∞–Ω–≥', '–∞—Ä—Ö–∞ÃÅ–≥–≥'=>'–∞—Ä—Ö–∞–Ω–≥',
                     '–≤–∞—Ä–∞ÃÅ–≥–≥'=>'–≤–∞—Ä–∞–Ω–≥', '–∫–µÃÅ–≥—Ö'=>'–∫–µ–Ω—Ö', '–∫–µ–≥—Ö'=>'–∫–µ–Ω—Ö', '–ø–∞–≥—Ö'=>'–ø–∞–Ω—Ö', '–∞“Ü–≥—Ö'=> '–∞–Ω—Ö',
                     
                     // Izhitsa is special
                     '—µ“ÜÃÅ'=> '–∏', '—µ“Ü'=> '–∏', '—∑'=> '–∏',
                     mb_chr(1141).mb_chr(768) => '–∏',  mb_chr(1141).mb_chr(769) => '–∏', mb_chr(1141).mb_chr(785) => '–∏', mb_chr(1141).mb_chr(843) => '–∏',
                     mb_chr(1141).mb_chr(776) => '–∏',  mb_chr(1141).mb_chr(783) => '–∏', mb_chr(1141).mb_chr(787) => '–∏', mb_chr(1141).mb_chr(787) => '–∏',
                     mb_chr(1141) => '–≤',
                     
                     // –π is –π,  Ãæ is —ä but only before e —è —é
                     '–∏ÃÜ' => '–π', mb_chr(830).'–µ' => '—ä–µ', mb_chr(830).'—î' => '—ä–µ', mb_chr(830).'—£' => '—ä–µ',
                     mb_chr(830).'—è' => '—ä—è', mb_chr(830).'—ß' => '—ä—è', mb_chr(830).'Íôó' => '—ä—è', mb_chr(830).'—é' => '—ä—é',
                     // otherwise remove it
                     mb_chr(830) => '',
                     //mb_chr(1080).mb_chr(785) => '–π',
                     
                     //  remove any accents, breath and dieresis
                     mb_chr(768) => '', mb_chr(785) => '', mb_chr(834) =>  '', mb_chr(769) => '', mb_chr(847) => '',
                     mb_chr(776) => '', mb_chr(774) => '', mb_chr(783) => '', mb_chr(787) => '', mb_chr(788) => '',
                     mb_chr(1155) => '', // this is titlo ~
                     mb_chr(1158) => '', mb_chr(1159) => '',
                     
                     // Slavonic to Civil
                     '–æ—É“ÜÃÅ'=> '—É', '–æ—É“ÜÃÄ'=> '—É', '–æ—É“Ü' => '—É',
                     '·≤Ç—É“ÜÃÅ'=> '—É', '·≤Ç—É“ÜÃÄ'=> '—É', '·≤Ç—É“Ü' => '—É',
                     //'–æ—É'=> '—É', don't do this without psili: –ø–æ—É—á–µ–Ω–∏–µ, –±–ª–∞–≥–æ—É—Ç—Ä–æ–±–∏–µ
                     '—î' => '–µ', '—ï' => '–∑', '—ñ' => '–∏', '—ó'=> '–∏', '—°' => '–æ', '—£' => '–µ', '—ß'=> '—è', '—´' => '—É', '—Ø' => '–∫—Å', '—±' => '–ø—Å',
                     '—≥' => '—Ñ', '—ª' => '–æ', '—Ω' => '–æ', '—ø'=> '–æ—Ç', 'Íôã' => '—É', 'Íôó'=> '—è', '—ù'=> '–∏', '—ê'=> '–µ',
                     
                     '“Ç'=> '1000*', // ugly fallback for thousands not in the number list above
                     
                     // Lone letter titlos mean no proper word was found, so as a last resort...
                     mb_chr(11744)=> '–±', mb_chr(11745)=> '–≤', mb_chr(11746)=> '–≥', mb_chr(11747)=> '–¥', mb_chr(11748)=> '–∂',
                     mb_chr(11750)=> '–∫', mb_chr(11751)=> '–ª', mb_chr(11752)=> '–º', mb_chr(11753)=> '–Ω', mb_chr(11754)=> '–æ',
                     mb_chr(11756)=> '—Ä', mb_chr(11757)=> '—Å', mb_chr(11759)=> '—Ö', mb_chr(11761)=> '—á', mb_chr(11764)=> '—Ñ',
                     
                     // these are in fact "separators" and shouldn't be in the word at all
                     // but in case text-splitting algorithm goes wrong... 
                     'Íôæ' => ' ', '‚ÄØ'=> ' ',

					//'üïÖ' => '–ú–∞—Ä–∫. –≥–ª.:',
                     
                     // low-digit numbers should be processed last
                     // (and that happens because of their short string length of course
                     // not because they're at the end of the list)
                     '—á“É—≥'=>'99', '—á“É–∏'=>'98', '—á“É–∑'=>'97', '—á“É—ï'=>'96', '—á“É—î'=>'95', '—á“É–¥'=>'94', '—á“É–≥'=>'93', '—á“É–≤'=>'92', '—á“É–∞'=>'91', '—á“É'=>'90',
                     '–ø“É—≥'=>'89', '–ø“É–∏'=>'88', '–ø“É–∑'=>'87', '–ø“É—ï'=>'86', '–ø“É—î'=>'85', '–ø“É–¥'=>'84', '–ø“É–≥'=>'83', '–ø“É–≤'=>'82', '–ø“É–∞'=>'81', '–ø“É'=>'80',
                     '—ª“É—≥'=>'79', '—ª“É–∏'=>'78', '—ª“É–∑'=>'77', '—ª“É—ï'=>'76', '—ª“É—î'=>'75', '—ª“É–¥'=>'74', '—ª“É–≥'=>'73', '—ª“É–≤'=>'72', '—ª“É–∞'=>'71', '—ª“É'=>'70',
                     '—Ø“É—≥'=>'69', '—Ø“É–∏'=>'68', '—Ø“É–∑'=>'67', '—Ø“É—ï'=>'66', '—Ø“É—î'=>'65', '—Ø“É–¥'=>'64', '—Ø“É–≥'=>'63', '—Ø“É–≤'=>'62', '—Ø“É–∞'=>'61', '—Ø“É'=>'60',
                     '–Ω“É—≥'=>'59', '–Ω“É–∏'=>'58', '–Ω“É–∑'=>'57', '–Ω“É—ï'=>'56', '–Ω“É—î'=>'55', '–Ω“É–¥'=>'54', '–Ω“É–≥'=>'53', '–Ω“É–≤'=>'52', '–Ω“É–∞'=>'51', '–Ω“É'=>'50',
                     '–º“É—≥'=>'49', '–º“É–∏'=>'48', '–º“É–∑'=>'47', '–º“É—ï'=>'46', '–º“É—î'=>'45', '–º“É–¥'=>'44', '–º“É–≥'=>'43', '–º“É–≤'=>'42', '–º“É–∞'=>'41', '–º“É'=>'40',
                     '–ª“É—≥'=>'39', '–ª“É–∏'=>'38', '–ª“É–∑'=>'37', '–ª“É—ï'=>'36', '–ª“É—î'=>'35', '–ª“É–¥'=>'34', '–ª“É–≥'=>'33', '–ª“É–≤'=>'32', '–ª“É–∞'=>'31', '–ª“É'=>'30',
                     '–∫“É—≥'=>'29', '–∫“É–∏'=>'28', '–∫“É–∑'=>'27', '–∫“É—ï'=>'26', '–∫“É—î'=>'25', '–∫“É–¥'=>'24', '–∫“É–≥'=>'23', '–∫“É–≤'=>'22', '–∫“É–∞'=>'21', '–∫“É'=>'20',
                     '–∑“É—ñ'=>'17', '–∑“É—ñÃà'=>'17', '–∏“É—ñ'=>'18', '–∏“É—ñÃà'=>'18',
                     '–∞“É—ñÃà'=>'11', '–∞“É—ñ'=>'11', '–∞—ñ“É'=>'11', '–≤“É—ñ'=>'12', '–≤“É—ñÃà'=>'12', '–≤—ñ“É'=>'12', '–≥“É—ñ'=>'13', '–≥“É—ñÃà'=>'13', '–≥—ñ“É'=>'11', '–¥—ñ“É'=>'14', '–¥“É—ñ'=>'14', '–¥“É—ñÃà'=>'14', '—î“É—ñ'=>'15', '—ï“É—ñ'=>'16', '—≥“É—ñ'=>'19',
                     
                     '–∞“É'=>'1', '–≤“É'=>'2', '–≥“É'=>'3', '–¥“É'=>'4', '–¥ÃÅ“É'=>'4', '—î“É'=>'5', '–µ“É'=>'5', '—ï“É'=>'6', '–∑“É'=>'7', '–∏“É'=>'8', '—≥“É'=>'9', '—ñ“É'=>'10',
                     '—Ä“É'=>'100', '—Å“É'=>'200', '—Ç“É'=>'300','—É“É'=>'400' , '—Ñ“É'=>'500',
                     );
    
    $result = strtr($csl, $replace);
    
    if (mb_substr($result, -1, 1, 'UTF-8') == '—ä')
    {
        return mb_substr($result, 0, mb_strlen($result)-1, 'UTF-8');
    }
    else
    {
        return $result;
    }
}
    
    
 
    


?>
